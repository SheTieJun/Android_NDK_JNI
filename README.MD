# Android NDK å¤šåª’ä½“å¤„ç†åº“é›†åˆ

[![Android](https://img.shields.io/badge/Android-API%2021+-green.svg)](https://developer.android.com/about/versions/android-5.0)
[![NDK](https://img.shields.io/badge/NDK-r21+-orange.svg)](https://developer.android.com/ndk)


## ğŸš€ é¡¹ç›®ç®€ä»‹

- ğŸµ **é«˜è´¨é‡éŸ³é¢‘ç¼–ç **: åŸºäº LAME çš„ MP3 ç¼–ç åŠŸèƒ½
- ğŸšï¸ **å®æ—¶éŸ³æ•ˆå¤„ç†**: æ”¯æŒå˜é€Ÿã€å˜è°ƒçš„éŸ³é¢‘å¤„ç†
- ğŸ¬ **è§†é¢‘è½¬ç å¤„ç†**: åŸºäº FFmpeg çš„è§†é¢‘ç¼–è§£ç 
- ğŸŒ **ç½‘ç»œé€šä¿¡**: æ”¯æŒ HTTPS è¯·æ±‚å’Œ JSON æ•°æ®å¤„ç†
- ğŸ”‡ **å™ªéŸ³æŠ‘åˆ¶**: WebRTC å™ªéŸ³æŠ‘åˆ¶æ¨¡å—
- ğŸ“± **Android 15 å…¼å®¹**: æ”¯æŒ 16KB é¡µé¢å¤§å°

## ğŸ“¦ æ¨¡å—è¯´æ˜

### [LAME MP3 ç¼–ç å™¨](lame)

**åŠŸèƒ½**: é«˜è´¨é‡çš„ MPEG éŸ³é¢‘å±‚ III (MP3) ç¼–ç å™¨

- **å®˜æ–¹ç½‘ç«™**: [lame.sourceforge.io](http://lame.sourceforge.io/index.php)
- **è®¸å¯è¯**: LGPL
- **ä¸»è¦ç‰¹æ€§**:
    - æ”¯æŒå¤šç§æ¯”ç‰¹ç‡ç¼–ç  (32-320 kbps)
    - VBR (å¯å˜æ¯”ç‰¹ç‡) ç¼–ç æ”¯æŒ
    - é«˜è´¨é‡éŸ³é¢‘å‹ç¼©ç®—æ³•

### [SoundTouch éŸ³é¢‘å¤„ç†](soundTouch)

**åŠŸèƒ½**: å®æ—¶éŸ³é¢‘å˜é€Ÿå˜è°ƒå¤„ç†åº“

- **å®˜æ–¹ç½‘ç«™**: [surina.net/soundtouch](http://www.surina.net/soundtouch)
- **æºç åœ°å€**: [codeberg.org/soundtouch](https://codeberg.org/soundtouch/soundtouch)
- **è®¸å¯è¯**: LGPL
- **ä¸»è¦ç‰¹æ€§**:
    - ç‹¬ç«‹çš„å˜é€Ÿå’Œå˜è°ƒå¤„ç†
    - å®æ—¶éŸ³é¢‘å¤„ç†èƒ½åŠ›
    - é«˜è´¨é‡çš„éŸ³é¢‘ç®—æ³•

### [FFmpeg å¤šåª’ä½“æ¡†æ¶](ffmpeg)

**åŠŸèƒ½**: å®Œæ•´çš„å¤šåª’ä½“å¤„ç†è§£å†³æ–¹æ¡ˆ

- **å®˜æ–¹ç½‘ç«™**: [ffmpeg.org](https://www.ffmpeg.org/)
- **æºç åœ°å€**: [github.com/FFmpeg/FFmpeg](https://github.com/FFmpeg/FFmpeg)
- **ä¸»è¦ç‰¹æ€§**:
    - æ”¯æŒå¤šç§éŸ³è§†é¢‘æ ¼å¼
    - å¼ºå¤§çš„è½¬ç èƒ½åŠ›
    - ä¸°å¯Œçš„æ»¤é•œæ•ˆæœ

### [ç½‘ç»œå·¥å…·é›†](tools)

#### cURL ç½‘ç»œåº“
- **æºç åœ°å€**: [github.com/curl/curl](https://github.com/curl/curl)
- **API æ–‡æ¡£**: [curl.se/libcurl/c](https://curl.se/libcurl/c/)
- **åŠŸèƒ½**: é«˜æ€§èƒ½çš„ HTTP/HTTPS ç½‘ç»œè¯·æ±‚åº“

#### OpenSSL åŠ å¯†åº“
- **æºç åœ°å€**: [github.com/openssl/openssl](https://github.com/openssl/openssl)
- **åŠŸèƒ½**: æä¾› SSL/TLS åŠ å¯†é€šä¿¡æ”¯æŒ

#### JsonCpp JSON è§£æåº“
- **æºç åœ°å€**: [github.com/open-source-parsers/jsoncpp](https://github.com/open-source-parsers/jsoncpp)
- **API æ–‡æ¡£**: [jsoncpp-docs](http://open-source-parsers.github.io/jsoncpp-docs/doxygen/index.html)
- **åŠŸèƒ½**: é«˜æ•ˆçš„ C++ JSON æ•°æ®è§£æåº“

### [WebRTC å™ªéŸ³æŠ‘åˆ¶](webrtc-ns)

**åŠŸèƒ½**: å®æ—¶éŸ³é¢‘å™ªéŸ³æŠ‘åˆ¶æ¨¡å—

- **å®˜æ–¹ç½‘ç«™**: [webrtc.org](https://webrtc.org/)
- **æºç åœ°å€**: [WebRTC NS Module](https://webrtc.googlesource.com/src/+/refs/heads/main/modules/audio_processing/ns)
- **ä¸»è¦ç‰¹æ€§**:
    - å®æ—¶å™ªéŸ³æ£€æµ‹å’ŒæŠ‘åˆ¶
    - ä½å»¶è¿Ÿå¤„ç†
    - é«˜è´¨é‡çš„éŸ³é¢‘è¾“å‡º


## ğŸ“š ä½¿ç”¨è¯´æ˜

### LAME ä½¿ç”¨ç¤ºä¾‹

```kotlin
// åˆå§‹åŒ– LAME ç¼–ç å™¨
val lameUtils = LameUtils()
lameUtils.init(44100, 2, 128) // é‡‡æ ·ç‡, å£°é“æ•°, æ¯”ç‰¹ç‡

// ç¼–ç éŸ³é¢‘æ•°æ®
val mp3Buffer = ByteArray(1024)
val result = lameUtils.encode(audioData, audioData, mp3Buffer)

// å®Œæˆç¼–ç 
lameUtils.destroy()
```

### SoundTouch ä½¿ç”¨ç¤ºä¾‹

```kotlin
// åˆ›å»º SoundTouch å®ä¾‹
val soundTouch = SoundTouch()
soundTouch.setSampleRate(44100)
soundTouch.setChannels(2)

// è®¾ç½®å˜é€Ÿå’Œå˜è°ƒ
soundTouch.setTempo(1.2f)  // æé€Ÿ 20%
soundTouch.setPitch(1.1f)  // å‡è°ƒ 10%

// å¤„ç†éŸ³é¢‘æ•°æ®
soundTouch.putSamples(inputBuffer, numSamples)
val outputSamples = soundTouch.receiveSamples(outputBuffer, maxSamples)
```

## âš™ï¸ é…ç½®å‚æ•°

### Android 15 å…¼å®¹æ€§é…ç½®

ä¸ºäº†å…¼å®¹ Android 15 çš„ 16KB é¡µé¢å¤§å°ï¼Œéœ€è¦åœ¨ CMakeLists.txt ä¸­æ·»åŠ ä»¥ä¸‹é…ç½®ï¼š

```cmake
# CMake 3.13 ä¹‹å‰
target_link_libraries(your_target "-Wl,-z,max-page-size=16384")

# CMake 3.13 åŠä»¥åç‰ˆæœ¬
target_link_options(your_target PRIVATE "-Wl,-z,max-page-size=16384")
```


## â“ å¸¸è§é—®é¢˜

### Q: ç¼–è¯‘æ—¶å‡ºç° NDK ç‰ˆæœ¬ä¸å…¼å®¹é—®é¢˜ï¼Ÿ
**A**: è¯·ç¡®ä¿ä½¿ç”¨ NDK r21 æˆ–æ›´é«˜ç‰ˆæœ¬ï¼Œå¹¶åœ¨ `build.gradle` ä¸­æ­£ç¡®é…ç½® `ndkVersion`ã€‚

### Q: åœ¨ Android 15 è®¾å¤‡ä¸Šå´©æºƒï¼Ÿ
**A**: è¯·ç¡®ä¿åœ¨ CMakeLists.txt ä¸­æ·»åŠ äº† 16KB é¡µé¢å¤§å°çš„é“¾æ¥é€‰é¡¹ã€‚

### Q: éŸ³é¢‘å¤„ç†å»¶è¿Ÿè¿‡é«˜ï¼Ÿ
**A**: å»ºè®®è°ƒæ•´éŸ³é¢‘ç¼“å†²åŒºå¤§å°ï¼Œä½¿ç”¨è¾ƒå°çš„ç¼“å†²åŒºå¯ä»¥é™ä½å»¶è¿Ÿã€‚

### Q: å¦‚ä½•ä¼˜åŒ–åº“çš„å¤§å°ï¼Ÿ
**A**: å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼ä¼˜åŒ–ï¼š
- åªç¼–è¯‘éœ€è¦çš„æ¶æ„ (å¦‚ä»…ä¿ç•™ arm64-v8a)
- ç§»é™¤ä¸éœ€è¦çš„åŠŸèƒ½æ¨¡å—
- å¯ç”¨ç¼–è¯‘å™¨ä¼˜åŒ–é€‰é¡¹

### Q: æ”¯æŒå“ªäº›éŸ³é¢‘æ ¼å¼ï¼Ÿ
**A**:
- **è¾“å…¥æ ¼å¼**: PCM, WAV
- **è¾“å‡ºæ ¼å¼**: MP3 (é€šè¿‡ LAME), å„ç§æ ¼å¼ (é€šè¿‡ FFmpeg)

## ğŸ”— ç›¸å…³é“¾æ¥
- [Android NDK å®˜æ–¹æ–‡æ¡£](https://developer.android.com/ndk)
- [CMake å®˜æ–¹æ–‡æ¡£](https://cmake.org/documentation/)
 

